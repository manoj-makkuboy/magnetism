<superconf>
    <parameter name="basedir">/srv/dumbhippo</parameter>
    <parameter name="baseport">21000</parameter>
    <parameter name="svndir">$superdir/..</parameter>
    
    <service name="jboss"
             class="dumbhippo.super.JBossService">
       <parameter name="jbossdir">/opt/jboss</parameter>
       <parameter name="targetdir">$basedir/jboss</parameter>

       <parameter name="jnpPort">$((baseport+10))</parameter>
       <parameter name="jrmpRmiPort">$((baseport+11))</parameter>
 
       <merge src="$jbossdir/server/all"
              exclude="$superdir/jboss/jboss.exclude"
              symlink="yes"/>
       <!-- The 'all' config is clustered, we need a non-clustered configiration for TomCat -->
       <merge src="$jbossdir/server/default/deploy/jbossweb-tomcat55.sar/META-INF/jboss-service.xml"
              dest="deploy/jbossweb-tomcat55.sar/META-INF/jboss-service.xml"
              symlink="yes"/>
       <merge src="$superdir/jboss/files"
              expand="yes"/>
       <merge src="$svndir/bin/jars/dumbhippo.ear"
              dest="deploy/dumbhippo.ear"
              hot="yes"/>
  
       <parameter name="startCommand">$superdir/jboss/jboss-start.sh $jbossdir $targetdir $jnpPort</parameter>
       <parameter name="stopCommand">$jbossdir/bin/shutdown.sh -s jnp://localhost:$jnpPort</parameter>
    </service>
</superconf>
