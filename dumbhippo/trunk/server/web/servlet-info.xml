<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
    version="2.4">

   <display-name>DumbHippo</display-name>
   <description>
       The DumbHippo web application  
   </description>
   
   <!-- URLs hard-coded to go to our custom servlets -->
    
   <servlet>
      <servlet-name>HippoServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.HippoServlet</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet>   

    <servlet>
      <servlet-name>PhotoServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.PhotoServlet</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet>   

    <servlet>
      <servlet-name>FileServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.FileServlet</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet>   

    <servlet>
      <servlet-name>WantsInServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.WantsInServlet</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet> 

    <servlet>
      <servlet-name>AbnormalErrorServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.AbnormalErrorServlet</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet>

	<!--  I can't figure out how to handle "all error codes" - "*" doesn't work afaict -->
	<error-page>
      <error-code>404</error-code>
      <location>/unknownlink</location>
	</error-page>

	<error-page>
      <error-code>500</error-code>
      <location>/abnormalerror</location>
	</error-page>

	<error-page>
		<exception-type>java.lang.Throwable</exception-type>
		<location>/abnormalerror</location>
	</error-page>

   <servlet-mapping>
      <servlet-name>HippoServlet</servlet-name>
      <url-pattern>/xmlrpc/*</url-pattern>
   </servlet-mapping>
    
   <servlet-mapping>
      <servlet-name>HippoServlet</servlet-name>
      <url-pattern>/xml/*</url-pattern>
   </servlet-mapping>
   
   <servlet-mapping>
      <servlet-name>HippoServlet</servlet-name>
      <url-pattern>/text/*</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>HippoServlet</servlet-name>
      <url-pattern>/action/*</url-pattern>
   </servlet-mapping>
   
   <servlet-mapping>
      <servlet-name>HippoServlet</servlet-name>
      <url-pattern>/redirect</url-pattern>
   </servlet-mapping>
   
   <servlet>
      <servlet-name>SendInviteServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.SendInviteServlet</servlet-class>
   </servlet>   
   
   <servlet-mapping>
      <servlet-name>SendInviteServlet</servlet-name>
      <url-pattern>/sendinvite</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>PhotoServlet</servlet-name>
      <url-pattern>/upload/headshots</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>PhotoServlet</servlet-name>
      <url-pattern>/upload/groupshots</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>FileServlet</servlet-name>
      <url-pattern>/files/*</url-pattern>
   </servlet-mapping>

   <servlet>
      <servlet-name>VerifyServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.VerifyServlet</servlet-class>
   </servlet>   
   
   <servlet-mapping>
      <servlet-name>VerifyServlet</servlet-name>
      <url-pattern>/verify</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>AbnormalErrorServlet</servlet-name>
      <url-pattern>/abnormalerror</url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>WantsInServlet</servlet-name>
      <url-pattern>/wantsin</url-pattern>
   </servlet-mapping>

   <!-- Map everything else to our URL-Rewriting servlet -->  

   <servlet>
      <servlet-name>RewriteServlet</servlet-name>
      <servlet-class>com.dumbhippo.web.RewriteServlet</servlet-class>
      <init-param>
          <param-name>requiresSignin</param-name>
          <param-value>home,welcome,invite,sharelink,tutorial,myphoto,newphoto,groupphoto</param-value>
      </init-param>
      <load-on-startup>1</load-on-startup>
   </servlet>   

   <servlet-mapping>
      <servlet-name>RewriteServlet</servlet-name>
      <url-pattern>/</url-pattern>
   </servlet-mapping>

   <welcome-file-list>
      <welcome-file>index.html</welcome-file>
   </welcome-file-list>
</web-app>
        
